---
- name: Import the NodeSource GPG key into apt
  apt_key: >
    url=https://deb.nodesource.com/gpgkey/nodesource.gpg.key
    state=present

- name: Add NodeSource deb repository
  apt_repository: >
    repo='deb https://deb.nodesource.com/node {{ ansible_distribution_release }} main'
    state=present

- name: Install latest Node.js and NPM
  apt: >
    pkg=nodejs
    state=latest
    update_cache=yes
    cache_valid_time={{ apt_cache_valid_time }}
  when: nodejs_version == "latest"

- name: Install specific verion of Node.js and NPM
  apt: >
    pkg=nodejs={{ nodejs_version }}-1chl1~{{ ansible_distribution_release }}1
    state=present
    update_cache=yes
    cache_valid_time={{ apt_cache_valid_time }}
  when: nodejs_version != "latest"
